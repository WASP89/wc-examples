<template>
  <style>
    p {
      padding: 10px;
      color: red;
    }
  </style>
  <p class="default-content"></p>
  <p class="time"></p>
</template>

<script>

  (function() {

    //prototipo de elemento, a partir del elemento base
    var prototype = Object.create(HTMLElement.prototype);

    //acceso a nuestro template
    var templateContent = document.currentScript.ownerDocument.querySelector('template').content;
    
    //manejador del evento created
    function onCreatedComponent() {

      // guardo el contenido del elemento y luego lo borro
      var elementContent = this.innerHTML;
      this.innerHTML = "";

      // clono el template
      var clone = document.importNode(templateContent, true);

      // acceso a los elementos concretos
      var defaultContent = clone.querySelector("p.default-content");
      var time = clone.querySelector("p.time");

      // inicializamos sus datos
      defaultContent.innerHTML = elementContent;
      time.innerHTML = new Date().toString();

      // a√±adimos como shadow dom
      this.createShadowRoot().appendChild(clone);
    }
    
    // definicion del manejador para el evento 'created'
    prototype.createdCallback = onCreatedComponent;

    //Registro el componente 'current-date'
    document.registerElement('current-date', {
      prototype: prototype
    });

  })()

</script>